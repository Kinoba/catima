<%= javascript_pack_tag 'template-editor-bundle' %>

<div class="form-group">
  <%= f.label('Item type') %>
  <div><%= @item_view.item_type.slug %></div>
</div>

<%= f.text_field(:name) %>

<%= f.check_box(:default_for_item_view) %>
<%= f.check_box(:default_for_list_view) %>

<hr>
<%= f.hidden_field(:template) %>
<%= f.label(:template) %>

<div id="template-tabs">

  <ul class="nav nav-tabs" style="margin-bottom: 15px;">
    <% @item_view.item_type.catalog.valid_locales.each_with_index do |l, i| %>
      <li role="presentation" class="<% if i==0 %>active<% end %>"><a href="#<%= l %>"><%= l %></a></li>
    <% end %>
  </ul>

  <div class="tab-content">
    <% @item_view.item_type.catalog.valid_locales.each_with_index do |l, i| %>
    <div role="tabpanel" class="tab-pane <% if i==0 %>active<% end %>" id="<%= l %>">
      <div class="tabcontent">
        <%= react_component("TemplateEditor", props: {
          :contentRef => "item_view_template",
          :locale => l,
          :fields => @item_view.item_type.fields.map { |f| {slug: f.slug, name: f.name} }
        }, prerender: false) %>
      </div>
    </div>
    <% end %>
  </div>

</div>
<script>
  $('#template-tabs .nav-tabs a').click(function (e) {
    e.preventDefault()
    $(this).tab('show')
  });
</script>

<hr>
